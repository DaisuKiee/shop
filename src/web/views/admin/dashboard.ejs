<%- include('./partials/admin-header') %>

<div class="admin-layout">
    <%- include('./partials/sidebar', { activePage: 'dashboard' }) %>
    
    <main class="admin-main">
        <div class="admin-topbar">
            <div>
                <h1>Dashboard</h1>
                <p>Welcome back, <%= user.username %></p>
            </div>
            <a href="/shop" class="btn-outline">View Shop</a>
        </div>
        
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-content">
                    <span class="stat-value"><%= stats.totalProducts %></span>
                    <span class="stat-label">Products</span>
                </div>
                <span class="stat-icon">üì¶</span>
            </div>
            <div class="stat-card">
                <div class="stat-content">
                    <span class="stat-value"><%= stats.totalCategories %></span>
                    <span class="stat-label">Categories</span>
                </div>
                <span class="stat-icon">üè∑Ô∏è</span>
            </div>
            <div class="stat-card">
                <div class="stat-content">
                    <span class="stat-value">‚Ç±<%= stats.totalRevenue.toLocaleString() %></span>
                    <span class="stat-label">Revenue</span>
                </div>
                <span class="stat-icon">üí∞</span>
            </div>
            <div class="stat-card">
                <div class="stat-content">
                    <span class="stat-value"><%= stats.pendingOrders %></span>
                    <span class="stat-label">Pending</span>
                </div>
                <span class="stat-icon">‚è≥</span>
            </div>
        </div>
        
        <div class="grid-2">
            <div class="card">
                <div class="card-header"><h3>Quick Actions</h3></div>
                <div class="card-body">
                    <div class="action-grid">
                        <a href="/admin/products" class="action-btn">
                            <span class="action-icon">‚ûï</span>
                            <span>Add Product</span>
                        </a>
                        <a href="/admin/categories" class="action-btn">
                            <span class="action-icon">üè∑Ô∏è</span>
                            <span>Categories</span>
                        </a>
                        <a href="/staff" class="action-btn">
                            <span class="action-icon">üìã</span>
                            <span>Orders</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header"><h3>Recent Activity</h3></div>
                <div class="card-body">
                    <% if (pendingOrders.length === 0 && completedOrders.length === 0) { %>
                    <div class="empty-state small">No recent activity</div>
                    <% } else { %>
                    <div class="activity-list">
                        <% pendingOrders.slice(0, 3).forEach(order => { %>
                        <div class="activity-item">
                            <span class="activity-badge pending">Pending</span>
                            <span class="activity-text"><%= order.username %> - <%= order.productName %></span>
                        </div>
                        <% }) %>
                        <% completedOrders.slice(-2).reverse().forEach(order => { %>
                        <div class="activity-item">
                            <span class="activity-badge <%= order.status %>"><%= order.status %></span>
                            <span class="activity-text"><%= order.productName %></span>
                        </div>
                        <% }) %>
                    </div>
                    <% } %>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h3>Recent Products</h3>
                <a href="/admin/products" class="link">View All ‚Üí</a>
            </div>
            <div class="card-body no-padding">
                <div class="products-grid" style="padding: 1rem;">
                    <% products.slice(0, 4).forEach(p => { %>
                    <div class="product-card" style="cursor: default;">
                        <div class="product-preview">
                            <img src="<%= p.previewImage %>" alt="<%= p.name %>">
                        </div>
                        <div class="product-info">
                            <div class="product-name"><%= p.name %></div>
                            <div class="product-bottom">
                                <div class="product-price">
                                    <img src="/img/nitro.webp" alt="" class="nitro-icon">
                                    <span class="price-amount">‚Ç±<%= p.price %></span>
                                    <% if (p.discount) { %>
                                    <span class="price-discount">(-<%= p.discount %>%)</span>
                                    <% } %>
                                </div>
                                <div class="product-stock">
                                    <span class="stock-dot <%= p.stock > 0 ? 'in-stock' : 'out-stock' %>"></span>
                                    <span><%= p.stock %> stock</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }) %>
                </div>
            </div>
        </div>
    </main>
</div>

<%- include('./partials/admin-styles') %>
<%- include('./partials/admin-footer') %>
